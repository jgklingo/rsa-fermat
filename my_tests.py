from fermat import fermat, miller_rabin, mod_exp
from rsa import ext_euclid

primes = [3, 5, 7, 11, 13, 17, 31, 37, 71, 73, 79, 97, 113, 131, 197, 199, 311, 337, 373, 719, 733, 919, 971, 991, 1193, 1931, 3119, 3779, 7793, 7937, 9311, 9377, 11939, 19391, 19937, 37199, 39119, 71993, 91193, 93719, 93911, 99371, 193939, 199933, 319993, 331999, 391939, 393919, 919393, 933199, 939193, 939391, 993319, 999331]
composites = [4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,140737488355328,281474976710656,562949953421312,1125899906842620,2251799813685240,4503599627370490,9007199254740990,18014398509481900,36028797018963900,72057594037927900,144115188075855000,288230376151711000,576460752303423000,1152921504606840000,2305843009213690000,4611686018427380000,9223372036854770000,18446744073709500000,36893488147419100000,73786976294838200000]
carmichaels = [561, 1105, 1729, 2465, 2821, 6601, 8911, 10585, 15841, 29341, 41041, 46657, 52633, 62745, 63973, 75361]

def my_test_fermat():
    for num in primes:
        assert fermat(num, 100) == 'prime'
    for num in composites:
        assert fermat(num, 100) == 'composite'
    for num in carmichaels:
        print(fermat(num, 1))

def my_test_mr():
    for num in primes:
        assert miller_rabin(num, 100) == 'prime'
    for num in composites:
        assert miller_rabin(num, 100) == 'composite'
    for num in carmichaels:
        print(miller_rabin(num, 100))
    

print(mod_exp(41, 3, 391))
